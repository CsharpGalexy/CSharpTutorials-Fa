# راهنمای ساده: فاینالایزرها و جمع‌آوری زباله (Garbage Collection) در C#

## 🎯 هدف
این مقاله برای برنامه‌نویسان تازه‌کار نوشته شده تا با مفاهیم مدیریت حافظه در فریم‌ورک .NET، نقش فاینالایزرها، الگوی Dispose و استفاده از SafeHandle آشنا بشن. هدف اینه که یاد بگیرین چطور منابع رو به شکل ایمن و کارآمد مدیریت کنین.

## 💡 مقدمه: مدیریت حافظه در .NET
در زبان C# و فریم‌ورک .NET، مدیریت حافظه به صورت خودکار انجام می‌شه. یعنی شما لازم نیست مثل زبان‌های C یا C++ به صورت دستی حافظه رو تخصیص بدین یا آزاد کنین. این کار توسط **Garbage Collector (GC)** انجام می‌شه.

GC مرتب بررسی می‌کنه که کدوم اشیاء دیگه در برنامه استفاده نمی‌شن (یعنی هیچ رفرنسی بهشون وجود نداره) و حافظه‌شون رو آزاد می‌کنه. این فرآیند از خطاهایی مثل **memory leak** یا **dangling pointers** جلوگیری می‌کنه.

اما یه نکته مهم وجود داره: GC فقط با **منابع مدیریت‌شده (managed resources)** مثل اشیاء .NET کار می‌کنه. اگر کلاس شما با **منابع غیرمدیریت‌شده (unmanaged resources)** مثل فایل‌ها، اتصالات دیتابیس یا هندل‌های سیستم‌عامل کار کنه، GC نمی‌تونه این منابع رو به تنهایی آزاد کنه. اینجا فاینالایزرها و الگوی Dispose وارد بازی می‌شن.

## 🧹 فاینالایزر چیست؟
فاینالایزر (که در C# بهش **destructor** هم می‌گن) یه متد خاصه که قبل از اینکه GC یه شیء رو کاملاً از حافظه پاک کنه، اجرا می‌شه. این متد فرصتیه برای آزاد کردن منابع غیرمدیریت‌شده، مثل بستن فایل یا آزاد کردن هندل‌های سیستم.

### 🔑 ویژگی‌های فاینالایزر:
- توسط GC فراخوانی می‌شه (برنامه‌نویس نمی‌تونه مستقیماً صداش کنه).
- زمان اجرای اون **غیرقابل پیش‌بینیه** (ممکنه دیر اجرا بشه یا حتی موقع خروج برنامه اجرا نشه).
- نباید به منابع مدیریت‌شده وابسته باشه (چون ممکنه این منابع قبلاً توسط GC پاک شده باشن).
- وجود فاینالایزر باعث می‌شه شیء به **صف فاینالایزیشن (finalization queue)** اضافه بشه و فرآیند جمع‌آوری حافظه کندتر بشه.